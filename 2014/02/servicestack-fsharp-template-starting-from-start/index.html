<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="last-modified" content="2015-06-25T12:06:26.9370780+05:30" />
    <title>Kunjan a.k.a. Kunjee's blog</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/style.css" />
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/ico">
    <link rel="shortcut icon" href="/images/favicon.gif" type="image/gif">
    <link rel="canonical" href="http://kunjan.in/2014/02/servicestack-fsharp-template-starting-from-start/" />
</head>
<body class="home blog">
    <div id="page" class="hfeed site">
        <header id="masthead" class="site-header fancy-container lightgreen" role="banner">
            <hgroup>
                <h1 class="site-title"><a href="/" title="Kunjee's Blog" rel="home">Kunjan's Blog</a></h1>
                <h2><small>Why Did the Chicken Cross the MÃ¶bius Strip?</small></h2>
                <p class="site-description"> All idea, opinion are my own and don't reflect opinion of my current or any former employer. </p>
                
        </hgroup>
        <nav role="navigation" class="site-navigation main-navigation">
            <h1 class="assistive-text">Menu</h1>
            <div class="assistive-text skip-link"><a href="#content" title="Skip to content">Skip to content</a></div>
            <div class="menu">
                <ul>

                    <li><a href="/category">Categories</a></li>
                    <li><a href="/archive">Archive</a></li>
                    <li><a href="/resume">Resume</a></li>
                    <li><a href="/about">About</a></li>
                    <li><a href="/search">Search</a></li>
                    <li><a href="/rss.xml">RSS</a> / <a href="/feed.xml">Atom</a></li>
                </ul>
            </div>
        </nav>
    </header>
    <div id="main">
        <div id="primary" class="site-content">
            <div id="content" role="main">

                
<meta name="description" content="It is all about getting started with service stack without any template." />
<meta name="author" content="Kunjan Dalal" />
<div id="post">
  <h1>Servicestack F# template. Starting from the Start.</h1>
  <div class="post-note">
    posted on 14 Feb 2014
    | <a href="/category/technical">Technical</a>
    | <a href="/category/dotnet">DotNet</a>
    | <a href="/category/oss">OSS</a>
    | <a href="/category/functional-programming">Functional Programming</a>

<!--       <div class="addthis_toolbox addthis_default_style" style="float:right;">
        <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
        <a class="addthis_button_tweet"></a>
        <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
        <a class="addthis_button_linkedin_counter"></a>
        <a class="addthis_counter addthis_pill_style"></a>
      </div>
    -->

    <!-- AddThis Button BEGIN -->
    <div class="hidden-phone">
      <div class="addthis_toolbox addthis_default_style addthis_32x32_style" addthis:title="Servicestack F# template. Starting from the Start.">
        <a class="addthis_button_preferred_1"></a>
        <a class="addthis_button_preferred_2"></a>
        <a class="addthis_button_preferred_3"></a>
        <a class="addthis_button_preferred_4"></a>
        <a class="addthis_button_compact"></a>
        <a class="addthis_counter addthis_bubble_style"></a>
      </div>
    </div>
    <!-- AddThis Button END -->




  </div>

  

  <p>I have already wrote a blog <a href="/2014/02/servicestack-fsharp-template-circle-is-complete/">post</a> about how to get started with service stack if any one is using templates. It is pretty easy. Just install and run.</p>

<p>But as <a href="http://servicestack.net/">Service Stack</a> is moved to V4 with some breaking changes. I had give details about updating it. But still it is little bit more complicated or confusing if I can say.</p>

<!--excerpt-->

<blockquote class="twitter-tweet" lang="en"><p><a href="https://twitter.com/kunjee">@kunjee</a> Sure, otherwise a tutorial on getting SS v4 + F# together without templates would be better than starting from a broken v3 one.</p>&mdash; Demis Bellot (@demisbellot) <a href="https://twitter.com/demisbellot/statuses/433545493738582016">February 12, 2014</a></blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Above is the conversation inspired me to write this blog. And also it will be fun to write back stories. </p>

<p>So, if any one want to get started with SS without templates. They need to download template of <a href="http://visualstudiogallery.msdn.microsoft.com/b55b8aac-b11a-4a6a-8a77-2153f46f4e2f">Nancy</a>. Yes, the cousin sibling of SS and other best thing happen to web part of  .Net after .Net it self.</p>

<p>Create new project and select Empty ASP.Net option. And remove all other packages. </p>

<blockquote>
  <p>we are doing this just to save our self from using complicated project GUIDs. If any one wanted to go raw, s/he need to select library project in F# and set GUID so it will be web application.</p>
</blockquote>

<p>Now install, SS from nuget. Preferably with Asp.Net host. Use this <code>Install-Package servicestack.Host.AspNet</code> . If any one prefer not search nuget.</p>

<p>Now, delete every file with .cs extension. <strong>Yes</strong>, we are doing it in <a href="http://fsharp.org">F#</a>.</p>

<p>Also, delete default.htm and *.js files. But keep the App_Start folder. We may need it.</p>

<p>It is almost done. Now, create AppHost.fs in App_start folder. Write a namespace you like and copy paste below code.</p>

<pre><code>type AppHost() = 
    inherit AppHostBase("Hello F# Service", typeof&lt;HelloService&gt;.Assembly)
    override this.Configure container = ignore()
    static member start() = 
        let apphost = new AppHost()
        apphost.Init() |&gt; ignore
</code></pre>

<p>Now, create HelloService.fs outside somewhere. and copy paste below code.</p>

<pre><code>[&lt;CLIMutable&gt;]
    type HelloResponse = 
        { Result : string }


    [&lt;Route("/hello")&gt;]
    [&lt;Route("/hello/{name}")&gt;]
    type Hello() = 
        interface IReturn&lt;HelloResponse&gt;
        member val Name = "" with get, set


    type HelloService() = 
        inherit Service()
        member this.Any(request : Hello) = { Result = "Hello " + request.Name }
</code></pre>

<p>Now, final settings. Add global.asax.fs file. And copy - paste below code.</p>

<pre><code>type Global() = 
    inherit System.Web.HttpApplication()

    member x.Application_Start (sender:Object, e:EventArgs) = 
        App_Start.AppHost.start() 
</code></pre>

<p>We also need to add global.asax file too.</p>

<p>Add this line to it</p>

<pre><code>&lt;%@ Application Inherits="ServicestackAspNetHost.Global" %&gt;
</code></pre>

<p>Do check for namespace name. This my project's namespace. </p>

<p>Now, you may get error that couple of system references are missing. Please add them. I got for System.data and also for System.xml.linq</p>

<blockquote>
  <p>F# visual studio project is poor with compilation sequence. So, do keep open project file in your favorite text editor. If there is some error like "xyxy" is not defined. Most of the time it is compilation sequence.</p>
</blockquote>

<p>If everything builds. It is out first victory. Run it. It should show, metadata page of SS.</p>

<p>It is done for people just wanted to create back end for their single page application or mobile application or thick client. </p>

<p>For complete web story lets add razor engine to it. Fire <code>Install-Package ServiceStack.Razor</code> in package manager.</p>

<p>Add Default.cshtml file. Add some html text to test.</p>

<p>Now, here is complicated part. We can't add folder in F# projects. But as it is Asp.Net web project too, we can add Asp.Net project folder. Add one of the folder and rename it to <em>Views</em>.</p>

<p>Add two files. One is _Layout.cshtml and other is Hello.cshtml. Don't forget to set compile type content for all cshtml files. </p>

<p>Here is content for _Layout.cshtml</p>

<pre><code>&lt;!doctype html&gt;
&lt;html lang="en-us"&gt;
&lt;head&gt;
    &lt;title&gt;@ViewBag.Title&lt;/title&gt;
    &lt;style type="text/css"&gt;
        body {
            background: #E6E6E6;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    @RenderBody()

    &lt;h6 style="font-size:12px; color: #999; position: fixed; bottom: -25px; right: 10px;"&gt;
        @Env.ServerUserAgent
    &lt;/h6&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>And here is content for Hello.cshtml</p>

<pre><code>@using ServiceStackAspNetHost
@inherits ViewPage&lt;HelloResponse&gt; 
@{
    Layout = "_Layout";
    ViewBag.Title = "Hello Page";
}

&lt;div&gt;
    Hello Page
    &lt;a href="/hello"&gt;Default Hello&lt;/a&gt;
    &lt;a href="/hello/fsharp"&gt;Hello With get Request&lt;/a&gt;


    &lt;br /&gt;
    &lt;br /&gt;
    &lt;p&gt;Model binding with DTO Response&lt;/p&gt;
    &lt;p&gt;@Model.Result&lt;/p&gt;

&lt;/div&gt;
</code></pre>

<p>Pretty much same as we do in C# projects. </p>

<p>We are almost done. Now we need to tell AppHost to add razor plugin. Change code as below</p>

<pre><code>override this.Configure container =
            this.Plugins.Add(new RazorFormat())
            ignore()
</code></pre>

<p>Now, rebuild and run it. It will show default page on "/" location and Hello page on "/Hello" location. Even you can access metadata page too.</p>

<p>Not that tough I guess. A little bit more code then normal one but as in F# it will be same as normal code in C#. </p>

<blockquote>
  <p>I love SS that is true thing, but I love Nancy too. Will not lie on <strong>Valentine's Day</strong>. Just to clarify as I used Nancy template to work with SS. If I have to do some web application work Nancy is weapon of choice and for API like thing SS is always there. People who created both are damn smart and more importantly friendly one. In .Net where OSS and OSS community story is not that good, these people are making the difference. Obviously I can't forget to mention F# community, they are awesome.</p>
</blockquote>


  <div id="disqus_thread"></div>
<script>
    var reset_disqus = function(){
        DISQUS.reset({
            reload: true,
            config: function () {
                //this.page.identifier = '';
                this.page.url = 'http://kunjan.in/2014/02/servicestack-fsharp-template-starting-from-start/';
                //this.page.title = '';
            }
        });
    };

    var disqus_shortname = 'kunjan';
    var disqus_url = 'http://kunjan.in/2014/02/servicestack-fsharp-template-starting-from-start/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    window.addEventListener('orientationchange', reset_disqus);
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f054dec05e2662c"></script>

</div>
            </div>
            <!-- #content -->
        </div>
        <!-- #primary .site-content -->

        <div id="secondary" class="widget-area fancy-container lightred" role="complementary">
            <aside id="text-5" class="widget widget_text">
                <h1 class="widget-title">Follow</h1>
                <div class="textwidget logos">
                    <a href="https://twitter.com/kunjee" target="_blank" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://twitter.com']);"><img src="/stylesheets/images/twitter.png"></a>
                    <a href="http://stackoverflow.com/users/859490/kunjee" target="_blank" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://stackoverflow.com']);"><img src="/stylesheets/images/stackoverflow.png"></a>
                    <a href="http://www.linkedin.com/in/kunjee17" target="_blank" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://www.linkedin.com']);"><img src="/stylesheets/images/linkedin.png"></a>
                    <a href="https://github.com/kunjee17" target="_blank" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://github.com']);"><img src="/stylesheets/images/github.png"></a>

                </div>
                <a href="http://stackoverflow.com/users/859490/kunjee" target="_blank">
                  <img src="http://stackoverflow.com/users/flair/859490.png" width="208" height="58" alt="profile for Kunjan at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for Kunjan at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
              </a>

          </aside>

          <aside id="linkcat-6" class="widget widget_links">
            <h1 class="widget-title">Other Blogs</h1>
            <ul class='xoxo blogroll'>
                <li><a href="http://www.hanselman.com/blog/" target="_blank" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://www.hanselman.com/blog/']);">Scott Hanselman</a></li>
                <li><a href="http://www.wekeroad.com/" target="_blank" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://www.wekeroad.com/']);">Rob Conery</a></li>
                <li><a href="http://haacked.com/" target="_blank" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://haacked.com/']);">Phil Haack</a></li>
                <li><a href="http://hanselminutes.com/" target="_blank" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://hanselminutes.com/']);">Hanselminutes</a></li>
                <li><a href="https://sergeytihon.wordpress.com/category/f-weekly/" target="_blank" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','https://sergeytihon.wordpress.com/category/f-weekly/']);">F# Weekly</a></li>
                <li><a href="http://fsharpforfunandprofit.com/" target="_blank" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://fsharpforfunandprofit.com/']);">F# for Fun and Profit</a></li>
            </ul>

        </aside>
        <aside id="archives-4" class="widget widget_archive">
            <h1 class="widget-title">Archive</h1>
            <ul class="posts">
                <li><a href="/archive#20154">April, 2015</a></li>
                <li><a href="/archive#20153">March, 2015</a></li>
                <li><a href="/archive#201411">November, 2014</a></li>
                <li><a href="/archive#201410">October, 2014</a></li>
                <li><a href="/archive#20146">June, 2014</a></li>
                <li><a href="/archive#20144">April, 2014</a></li>
                <li><a href="/archive#20143">March, 2014</a></li>
                <li><a href="/archive#20142">February, 2014</a></li>
                <li><a href="/archive#201312">December, 2013</a></li>
                <li><a href="/archive#201311">November, 2013</a></li>
                <li><a href="/archive#201310">October, 2013</a></li>
                <li><a href="/archive#20138">August, 2013</a></li>
                <li><a href="/archive#20131">January, 2013</a></li>
                <li><a href="/archive#201212">December, 2012</a></li>
                <li><a href="/archive#201211">November, 2012</a></li>
                <li><a href="/archive#201210">October, 2012</a></li>
                <li><a href="/archive#20129">September, 2012</a></li>
                <li><a href="/archive#20124">April, 2012</a></li>
                <li><a href="/archive#20123">March, 2012</a></li>
                <li><a href="/archive#20122">February, 2012</a></li>
                <li><a href="/archive#20121">January, 2012</a></li>
                <li><a href="/archive#201112">December, 2011</a></li>
                <li><a href="/archive#201111">November, 2011</a></li>
                <li><a href="/archive#201110">October, 2011</a></li>
        </ul>
    </aside>
</div>
<!-- #secondary .widget-area -->


</div>
<!-- #main -->

<footer id="colophon" class="site-footer" role="contentinfo">
    <div class="site-info">
        Powered by <a href="https://github.com/Sandra/Sandra.Snow" rel="generator">Sandra.Snow</a>.	
    </div>
    <!-- .site-info -->
</footer>
<!-- #colophon .site-footer -->
</div>
<!-- #page .hfeed .site -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src='/javascripts/prettify.js' type='text/javascript'></script>

<script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(['_setAccount', 'UA-37975068-1']);
_gaq.push(['_trackPageview']);
        
(function () {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
})();
</script>

<script type='text/javascript'>
  $(function () {
    $("pre code").parent().each(function () {
      if (!$(this).hasClass("prettyprint")) {
        $(this).addClass("prettyprint");
        a = true
    }
});

    prettyPrint();
});


  $(function(){
    $.ajax({
        url: "http://dynamic.xkcd.com/api-0/jsonp/comic?callback=?",
        dataType: "json",
        jsonpCallback: "xkcddata",
        success: function(data) {
            $("#xkcdcontent").append(
                $("<h1/>").text(data.title),
                $("<img/>").attr({
                    src: data.img,
                    title: data.alt,
                    alt: data.title
                })
                );
        }
    });
});
</script>
</body>
</html>
